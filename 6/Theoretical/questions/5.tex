\smalltitle{سوال 5}
\\\noindent
فرض کنید که ترد‌های 1 و 2 همزمان کارشان را شروع کنند و همزمان به خط
$y = true$
برسند. حال فرض کنید که به خاطر
\lr{race}
بین این دو،
$x = 1$
است و در نتیجه ترد شماره دوم وارد
\codeword{if(x != i)}
می‌شود. ترد شماره‌ی اول نیز وارد
\lr{critical section}
می‌شود. ترد دوم
$y = false$
را اجرا می‌کند و در
\lr{busy wait}
می‌رود تا
$x == 0$
شود.
حال فرض کنید که در همین حین که ترد اول در
\lr{critical section}
است و ترد دوم در
\lr{busy wait}،
ترد سوم نیز شروع به کار می‌کند. این ترد
$y = true$
می‌کند، و از آنجا که
\lr{race}
در
$x$
وجود نداشت، وارد
\lr{critical section}
می‌شود. حال فرض کنید که یکی از این ترد‌های 1 یا 3 از
\lr{critical section}
خارج می‌شود. این ترد،
$y = false$
قرار می‌دهد و
$x = 0$
می‌کند. این باعث می‌شود که ترد شماره 2 نیز از
\lr{busy wait}
خارج شود و به
$L$
برگردد. حال فرض کنید که یک ترد 4 نیز وجود داشت که تا حالا بر روی خط
$L$
ایستاده بود. حال این سه ترد دوباره مثل قبل می‌توانند دوتای آنها وارد
\lr{critical section}
شوند. بدین صورت که فرض کنید که ترد شماره 1 و 2 دوباره همزمان  شروع به اجرا شدن بکنند،
$x$
به خاطر
\lr{race}
مقدارش برابر
1 بشود
و در نتیجه 1 وارد
\lr{critical section}
بشود و 2 دوباره در
\lr{busy wait}
گیر کند. حال ترد شماره 4 نیز کار خود را شروع می‌کند و از آنجا که
$y == false$
است، وارد
\lr{critical section}
می‌شود. پس در حال حاضر 3 از 4 ترد ما در
\lr{critical section}
هستند. به طور مشابه می‌توان این کار را تا ابد ادامه داد. پس جواب مسئله‌ی ما
$k=n-1$
ترد است.