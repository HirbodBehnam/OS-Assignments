\smalltitle{سوال 5}
\\\noindent
فرض کنید که ترد‌های 1 و 2 همزمان کارشان را شروع کنند و همزمان به خط
$y = true$
برسند. حال فرض کنید که به خاطر
\lr{race}
بین این دو،
$x = 1$
است و در نتیجه ترد شماره دوم وارد
\codeword{if(x != i)}
می‌شود. ترد شماره‌ی اول نیز وارد
\lr{critical section}
می‌شود. ترد دوم
$y = false$
را اجرا می‌کند و در
\lr{busy wait}
می‌رود تا
$x == 0$
شود.
حال فرض کنید که در همین حین که ترد اول در
\lr{critical section}
است و ترد دوم در
\lr{busy wait}،
ترد سوم و چهارم نیز شروع به کار می‌کنند از اول حلقه‌ی اصلی.
فرض کنید که دوباره هر دو همزمان به خط
$y = true$
می‌رسند.
(دقت کنید که قبل از این به خاطر ترد دوم
$y$
برابر
\codeword{false}
بود!)
حال دوباره فرض کنید که به خاطر
\lr{race}،
$x = 3$
قرار گرفته می‌شود. پس دوباره مثل حالت قبل،
ترد شماره 3 وارد
\lr{critical section}
می‌شود در حالی که ترد شماره 1 نیز در آنجا است و ترد شماره 4 وارد
\lr{busy wait}
می‌شود. دقت کنید که باز هم ترد شماره 4،
$y = false$
قرار می‌دهد.
پس به همین ترتیب از هر 2 ترد که می‌آید حداکثر یک ترد می‌تواند وارد
\lr{critical section}
شود. پس در این مسئله
$k = \frac{n}{2}$
است. نکته‌ای که باید توجه کنید این است که اگر
$n$
فرد بود، می‌توان گفت که آخرین ترد نیز بدون شرط وارد
\lr{critical section}
می‌تواند بشود. پس جواب برابر است با
$k = \lceil \frac{n}{2} \rceil$